# future_challenge


## 说点废话

这是我第一个github项目，之所以把代码上传到GitHub之上是因为觉得有必要熟悉一下这逼格满满的操作，再则是这些代码已经写了有些时间了
所以很多细节有些遗忘，觉得有必要在这个平台上重新整理一下，相信这是一个不错的习惯，但愿在未来也会有些帮助。

废话不多说，这个项目是为了解决在阿里云天池上的竞赛项目：[气象数据领航无人飞行器线路优化大赛](https://tianchi.aliyun.com/competition/introduction.htm?spm=5176.100066.0.0.2c2390983syq0l&raceId=231622)

早前就想要参加一些机器学习的比赛，在kaggle上面搜索一番后觉得还是应该找一些简单的练练手，于是乎就找到了天池的这个项目
看起来应该是没什么难度的，以至于有一千多名队伍参加。奖金也很诱人，所以就决定在这个上面练练手了

## 比赛介绍
>   本次大赛的目标是为无人运输飞行器寻找一个可以避开危险气象区域的有效航行算法。在飞行器飞行之前，选手需要根据英国气象局预测的天气数据，计划无人机航行路线。英国气象局每天会运行 10 个不同的预测模型，得出稍有不同但基本准确的预测结果。然而，天气预测的准确率通常为 90% 到 95%。优胜的算法需要基于我们提供的每日天气预测数据，确保无人运输飞行器航线安全且最短。

>   为简化挑战，我们根据天气预报所覆盖的最小范围，对覆盖区域进行了区域块的划分，每一个区域块都可以用（x,y）唯一表示，x表示X轴方向的坐标值，y表示Y轴方向的坐标值。同时我们假设无人运输飞行器在所有天气条件下的飞行速度均保持不变，在每个区域块的飞行时长固定，限定为2分钟飞越一个区域块，且只能从当前区域块上下左右地飞越到下一个区域块，或者停留在当前区域。
  
>   每天3点钟10架推进式无人运输飞行器将从伦敦海德公园飞往英国其他10个目的地城市，限定最大飞行时长为18个小时 [03:00-21:00)。选手需要基于我们提供的天气预报数据，预测每个区域块（x,y）的天气情况，规划无人机的飞行轨迹，具体的数据说明与描述详见下一章。
>   同时赛题暂且只考虑影响无人飞行器坠毁的一个天气因素：风速。当风速值≥15时，无人机坠毁。

目标函数为:
                              `目标函数值 = 24*60*飞行器坠毁数 + 顺利到达的飞行器总飞行时长（分钟）`

## 比赛分析
这个比赛大致可以分为两个较为独立的部分：

- 数据的处理以及预测天气图的生成
- 对于预测天气图的路径规划问题

### 数据的处理
比赛的举办方提供了三组数据分别是：


- `ForecastDataforTraining`:十种预测模型对于前五天的风速预测
- `ForecastDataforTesting`:十种预测模型对于后五天的风速预测
- `In_situMeasurementforTraining`:前五天的真实风速值

由于在介绍中所提及的，每一个模型对于风速的预测准确度高达90%～95%（感觉都可以拿来直接用了）
但是为了获得最为优秀的预测模型，所以我决定对十种预测模型进行融合

融合的思想十分简单，就是将`ForecastDataforTraining`里十种模型的预测值
分别与`In_situMeasurementforTraining`的真实值求均方根误差
基于均方根误差后对`ForecastDataforTesting`里的十种模型进行加权求和，从而得到一个融合后的后五天风速预测

数据处理的代码在`/data`文件夹里，其中：

- `getModel.py`：将`ForecastDataforTraining`中的某个模型数据提取出来，存储为`.mat`格式
- `getGroundTruth.py`：将`In_situMeasurementforTraining`中的某个模型数据提取出来，存储为`.mat`格式
- `modelVar.py`：将`getGroundTruth.py`提取出来的模型数据安装日期时间排序（方便计算），再循环计算每个模型与真实值的均方根误差并输出命令行
- `modelExtract.sh`：为了省事写的脚本，功能是将`getModel.py`重复运行提取出十个模型的数据。

其实思路都还是挺简单，就是数据量过于庞大，4GB的csv训练数据用Excel都已经无法打开，所以必须要编程对数据进行一系列的处理
通过`modelVar.py`的运算后，得到的各个模型的RMSE值为：
`2.3452473930597999, 2.4057958282882739, 2.3378241868084735, 2.5266803221778158, 2.3765816290891069, 2.4230948602694733, 2.3681212512848147, 2.4593013541798214, 2.5012042761101116, 2.4184522510987279`

可以看出其实各个模型的RMSE差别并不是很大，这一点让我有些失望，但是还是照着原来的计划前进

接下来的工作就是将`ForecastDataforTesting`的十种模型根据各模型的RMSE进行加权求和，从而得到融合后的后五天预测值`testingDataFusion.mat`（这一文件已上传）

到这里，`testingDataFusion.mat`是我们数据处理方面的最终结果，到这里数据处理方面结束

### 飞行器路径规划问题

使用`resultProcess.py`可以将`testingDataFusion.mat`可视化呈现
即，将后五天各地的风速预测值显示并保存为图片，这里我使用了Photoshop将5天，每天18各小时共90张图做成GIF动画
下图是原始数据：
![](/resource/image/gif1.gif)

下面是阈值化后的图像，其中蓝色是危险区域：

![](/resource/image/gif2.gif)

题目中规定飞行器每隔2分钟飞跃一个方格，且每隔一个小时地图上的风速才变换一次，一个小时之内的风速保持不变。这就给我们提供了解决这一问题的思路
也就是局部使用寻路算法，每隔一小时刷新一次寻路轨迹。

这里采用的寻路算法是A-star算法，实现方法封装在`AStar.py`之中.

在`submitCSV.py`中实现了对A-Star算法的调用、飞行轨迹的生成以及飞行轨迹写入到csv文件的操作。










